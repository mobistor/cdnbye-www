(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{492:function(a,t,s){"use strict";s.r(t);var n=s(4),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"环境配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境配置"}},[a._v("#")]),a._v(" 环境配置")]),a._v(" "),s("h3",{attrs:{id:"开发环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发环境"}},[a._v("#")]),a._v(" 开发环境")]),a._v(" "),s("ul",[s("li",[a._v("Android Studio 开发工具，"),s("a",{attrs:{href:"http://developer.android.com/intl/zh-cn/sdk/index.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("下载地址"),s("OutboundLink")],1)])]),a._v(" "),s("h3",{attrs:{id:"开启java8支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开启java8支持"}},[a._v("#")]),a._v(" 开启Java8支持")]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("app/build.gradle")]),a._v("中加入以下配置以开启Java8支持：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("android {\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n}\n")])])]),s("h3",{attrs:{id:"添加相关权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加相关权限"}},[a._v("#")]),a._v(" 添加相关权限")]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("app/src/main")]),a._v("目录中的"),s("code",[a._v("AndroidManifest.xml")]),a._v("中增加如下权限声明:")]),a._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("uses-permission")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("android:")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("android.permission.INTERNET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("/>")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("uses-permission")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("android:")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("android.permission.ACCESS_NETWORK_STATE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("/>")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("uses-permission")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("android:")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("android.permission.READ_EXTERNAL_STORAGE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("/>")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("uses-permission")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("android:")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("android.permission.WRITE_EXTERNAL_STORAGE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("/>")])]),a._v("\n")])])]),s("h3",{attrs:{id:"允许http请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#允许http请求"}},[a._v("#")]),a._v(" 允许HTTP请求")]),a._v(" "),s("p",[a._v("从Android P系统开始，如果应用使用的是非加密的明文流量的http网络请求，则会导致该应用无法进行网络请求，https则不会受影响。由于本地代理服务需要使用http协议访问，针对这个问题，有以下两种解决方法：\n"),s("br"),a._v("\n（1） "),s("code",[a._v("targetSdkVersion")]),a._v(" 降到27以下\n"),s("br"),a._v("\n（2） 更改网络安全配置，在"),s("code",[a._v("app/src/main")]),a._v("目录中的"),s("code",[a._v("AndroidManifest.xml")]),a._v("的"),s("code",[a._v("<application>")]),a._v("标签中直接插入：")]),a._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("application")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("...")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("android:")]),a._v("usesCleartextTraffic")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("...")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("/>")])]),a._v("\n")])])]),s("h3",{attrs:{id:"混淆配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#混淆配置"}},[a._v("#")]),a._v(" 混淆配置")]),a._v(" "),s("p",[a._v("为了保证正常使用 SDK ，请在 proguard-rules.pro 文件中添加以下代码：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("-dontwarn com.cdnbye.**\n-keep class com.cdnbye.**{*;}\n-keep interface com.cdnbye.**{*;}\n-dontwarn org.webrtc.**\n-keep class org.webrtc.**{*;}\n")])])]),s("h2",{attrs:{id:"导入sdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入sdk"}},[a._v("#")]),a._v(" 导入SDK")]),a._v(" "),s("h3",{attrs:{id:"gradle方式导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gradle方式导入"}},[a._v("#")]),a._v(" Gradle方式导入")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("dependencies {\n  implementation 'com.cdnbye:sdk:latest.release'\n}\n")])])]),a._v(" "),s("h2",{attrs:{id:"快速开始"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速开始"}},[a._v("#")]),a._v(" 快速开始")]),a._v(" "),s("p",[a._v("推荐在"),s("code",[a._v("Application.OnCreate()")]),a._v("中启动P2P加速服务。在播放之前使用parseStreamUrl()方法去转换播放地址开始播放。")]),a._v(" "),s("h3",{attrs:{id:"导入-p2pengine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入-p2pengine"}},[a._v("#")]),a._v(" 导入 P2pEngine")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("cdnbye"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sdk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("P2pEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("h3",{attrs:{id:"实例化-p2pengine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例化-p2pengine"}},[a._v("#")]),a._v(" 实例化 P2pEngine")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("MyApplication")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("extends")]),a._v(" android"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Application")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("onCreate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("onCreate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("P2pEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("initEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" YOUR_TOKEN"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("其中 YOUR_TOKEN 是用于标识用户的字符串，请换成自己的token，点击"),s("RouterLink",{attrs:{to:"/views/bindings.html#绑定-app-id-并获取token"}},[a._v("这里")]),a._v("查看如何注册"),s("code",[a._v("Appid")]),a._v("并获取"),s("code",[a._v("token")]),a._v("。")],1),a._v(" "),s("h3",{attrs:{id:"获取播放地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取播放地址"}},[a._v("#")]),a._v(" 获取播放地址")]),a._v(" "),s("p",[a._v("使用加速功能，必须通过SDK把地址转换成加速地址，再把转换后的地址传给播放器即可（建议使用"),s("a",{attrs:{href:"https://github.com/google/ExoPlayer",target:"_blank",rel:"noopener noreferrer"}},[a._v("ExoPlayer"),s("OutboundLink")],1),a._v("）。")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("onPlay")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" parsedUrl "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("P2pEngine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parseStreamUrl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://your_stream.m3u8"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n  mediaPlayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("parsedUrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("就这么简单，你的播放器已经具备P2P能力了！")]),a._v(" "),s("h4",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[a._v("#")]),a._v(" 示例")]),a._v(" "),s("p",[a._v("获取完整的"),s("a",{attrs:{href:"https://github.com/cdnbye/android-p2p-engine",target:"_blank",rel:"noopener noreferrer"}},[a._v("示例程序"),s("OutboundLink")],1),a._v("。")]),a._v(" "),s("h4",{attrs:{id:"p2p无效问题排查步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#p2p无效问题排查步骤"}},[a._v("#")]),a._v(" P2P无效问题排查步骤")]),a._v(" "),s("p",[a._v("请参考"),s("RouterLink",{attrs:{to:"/views/FAQ.html#客户端sdk-p2p无效问题排查步骤"}},[a._v("常见问题")])],1),a._v(" "),s("h4",{attrs:{id:"解决exoplayer无法播放问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决exoplayer无法播放问题"}},[a._v("#")]),a._v(" 解决Exoplayer无法播放问题")]),a._v(" "),s("p",[a._v("请参考"),s("RouterLink",{attrs:{to:"/views/FAQ.html#解决exoplayer无法播放问题"}},[a._v("常见问题")])],1),a._v(" "),s("h4",{attrs:{id:"如何减小apk体积"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何减小apk体积"}},[a._v("#")]),a._v(" 如何减小APK体积")]),a._v(" "),s("p",[a._v("请参考"),s("RouterLink",{attrs:{to:"/views/FAQ.html#如何减小apk体积"}},[a._v("常见问题")])],1)])}),[],!1,null,null,null);t.default=e.exports}}]);